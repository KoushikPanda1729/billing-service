{
    "info": {
        "_postman_id": "billing-service-collection",
        "name": "Billing Service",
        "description": "Billing service API for customer, coupon, order, tax, and delivery management with JWT authentication.",
        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
    },
    "auth": {
        "type": "bearer",
        "bearer": [
            {
                "key": "token",
                "value": "{{access_token}}",
                "type": "string"
            }
        ]
    },
    "item": [
        {
            "name": "Authentication",
            "item": [
                {
                    "name": "Login",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 200) {",
                                    "    var jsonData = pm.response.json();",
                                    "    if (jsonData.accessToken) {",
                                    "        pm.environment.set('access_token', jsonData.accessToken);",
                                    "        console.log('Access token saved to environment');",
                                    "    }",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"email\": \"pa@gmail.com\",\n    \"password\": \"Panda@123@\"\n}"
                        },
                        "url": {
                            "raw": "{{auth_base_url}}/auth/login",
                            "host": ["{{auth_base_url}}"],
                            "path": ["auth", "login"]
                        },
                        "description": "Login to get access token.\n\n**Auto-saves:** access_token to environment\n\n**Test Credentials:**\n- Customer: pa@gmail.com / Panda@123@\n- Manager: manager20@example.com / ManagerPass123!\n- Admin: admin1@example.com / Admin@123456"
                    },
                    "response": []
                },
                {
                    "name": "Self",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{auth_base_url}}/auth/self",
                            "host": ["{{auth_base_url}}"],
                            "path": ["auth", "self"]
                        },
                        "description": "Get current logged-in user info."
                    },
                    "response": []
                },
                {
                    "name": "Refresh",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 200) {",
                                    "    var jsonData = pm.response.json();",
                                    "    if (jsonData.accessToken) {",
                                    "        pm.environment.set('access_token', jsonData.accessToken);",
                                    "    }",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [],
                        "url": {
                            "raw": "{{auth_base_url}}/auth/refresh",
                            "host": ["{{auth_base_url}}"],
                            "path": ["auth", "refresh"]
                        },
                        "description": "Refresh access token."
                    },
                    "response": []
                },
                {
                    "name": "Logout",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 200) {",
                                    "    pm.environment.set('access_token', '');",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [],
                        "url": {
                            "raw": "{{auth_base_url}}/auth/logout",
                            "host": ["{{auth_base_url}}"],
                            "path": ["auth", "logout"]
                        },
                        "description": "Logout and clear token."
                    },
                    "response": []
                }
            ],
            "description": "Auth service endpoints ({{auth_base_url}})"
        },
        {
            "name": "Health & Info",
            "item": [
                {
                    "name": "Root Endpoint",
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/",
                            "host": ["{{base_url}}"],
                            "path": [""]
                        },
                        "description": "Welcome message from the billing service"
                    },
                    "response": []
                }
            ]
        },
        {
            "name": "Customer Management",
            "item": [
                {
                    "name": "Get All Customers",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 200) {",
                                    "    pm.test('Customers list retrieved', function() {",
                                    "        pm.response.to.have.status(200);",
                                    "    });",
                                    "    ",
                                    "    pm.test('Response has customers array', function() {",
                                    "        var jsonData = pm.response.json();",
                                    "        pm.expect(jsonData).to.have.property('data');",
                                    "        pm.expect(jsonData.data).to.be.an('array');",
                                    "    });",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/customers?page={{page}}&limit={{limit}}",
                            "host": ["{{base_url}}"],
                            "path": ["customers"],
                            "query": [
                                {
                                    "key": "page",
                                    "value": "{{page}}"
                                },
                                {
                                    "key": "limit",
                                    "value": "{{limit}}"
                                },
                                {
                                    "key": "q",
                                    "value": "",
                                    "disabled": true
                                }
                            ]
                        },
                        "description": "Get all customers with pagination.\n\n**Requires:** Admin or Manager role\n\n**Query Parameters:**\n- page: Page number (default: 1)\n- limit: Items per page (default: 10)\n- q: Search query (optional)"
                    },
                    "response": []
                },
                {
                    "name": "Get Customer by ID",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 200) {",
                                    "    pm.test('Customer retrieved successfully', function() {",
                                    "        pm.response.to.have.status(200);",
                                    "    });",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/customers/{{customer_id}}",
                            "host": ["{{base_url}}"],
                            "path": ["customers", "{{customer_id}}"]
                        },
                        "description": "Get a specific customer by ID."
                    },
                    "response": []
                },
                {
                    "name": "Create Customer",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 201) {",
                                    "    var jsonData = pm.response.json();",
                                    "    pm.environment.set('customer_id', jsonData.customer._id);",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{}"
                        },
                        "url": {
                            "raw": "{{base_url}}/customers",
                            "host": ["{{base_url}}"],
                            "path": ["customers"]
                        },
                        "description": "Create a new customer profile. User data is extracted from JWT token."
                    },
                    "response": []
                },
                {
                    "name": "Update Customer",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"firstName\": \"Updated\",\n    \"lastName\": \"Customer\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/customers/{{customer_id}}",
                            "host": ["{{base_url}}"],
                            "path": ["customers", "{{customer_id}}"]
                        },
                        "description": "Update customer profile information. Address field NOT allowed here."
                    },
                    "response": []
                },
                {
                    "name": "Delete Customer",
                    "request": {
                        "method": "DELETE",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/customers/{{customer_id}}",
                            "host": ["{{base_url}}"],
                            "path": ["customers", "{{customer_id}}"]
                        },
                        "description": "Delete a customer. Requires Admin or Manager role."
                    },
                    "response": []
                },
                {
                    "name": "Add Address",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 200) {",
                                    "    var jsonData = pm.response.json();",
                                    "    if (jsonData.customer.address.length > 0) {",
                                    "        pm.environment.set('address_id', jsonData.customer.address[0]._id);",
                                    "    }",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"text\": \"{{new_address}}\",\n    \"isDefault\": false\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/customers/{{customer_id}}/addresses",
                            "host": ["{{base_url}}"],
                            "path": ["customers", "{{customer_id}}", "addresses"]
                        },
                        "description": "Add a new address to a customer."
                    },
                    "response": []
                },
                {
                    "name": "Update Address",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"text\": \"789 Updated Avenue, City, Country\",\n    \"isDefault\": true\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/customers/{{customer_id}}/addresses/{{address_id}}",
                            "host": ["{{base_url}}"],
                            "path": ["customers", "{{customer_id}}", "addresses", "{{address_id}}"]
                        },
                        "description": "Update a specific address."
                    },
                    "response": []
                },
                {
                    "name": "Delete Address",
                    "request": {
                        "method": "DELETE",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/customers/{{customer_id}}/addresses/{{address_id}}",
                            "host": ["{{base_url}}"],
                            "path": ["customers", "{{customer_id}}", "addresses", "{{address_id}}"]
                        },
                        "description": "Delete a specific address from a customer."
                    },
                    "response": []
                }
            ],
            "description": "Customer management endpoints."
        },
        {
            "name": "Coupon Management",
            "item": [
                {
                    "name": "Get All Coupons",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/coupons?page={{page}}&limit={{limit}}",
                            "host": ["{{base_url}}"],
                            "path": ["coupons"],
                            "query": [
                                {
                                    "key": "page",
                                    "value": "{{page}}"
                                },
                                {
                                    "key": "limit",
                                    "value": "{{limit}}"
                                },
                                {
                                    "key": "q",
                                    "value": "",
                                    "disabled": true
                                }
                            ]
                        },
                        "description": "Get all coupons with pagination. Admin sees all, Manager sees tenant coupons."
                    },
                    "response": []
                },
                {
                    "name": "Get Coupon by ID",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/coupons/{{coupon_id}}",
                            "host": ["{{base_url}}"],
                            "path": ["coupons", "{{coupon_id}}"]
                        },
                        "description": "Get a specific coupon by ID."
                    },
                    "response": []
                },
                {
                    "name": "Create Coupon (Admin)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 201) {",
                                    "    var jsonData = pm.response.json();",
                                    "    pm.environment.set('coupon_id', jsonData.coupon._id);",
                                    "    pm.environment.set('coupon_code', jsonData.coupon.code);",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"title\": \"Enjoy 10% Off\",\n    \"code\": \"ENJOY_10\",\n    \"discount\": 10,\n    \"validUpto\": \"2026-12-31\",\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/coupons",
                            "host": ["{{base_url}}"],
                            "path": ["coupons"]
                        },
                        "description": "Create a new coupon (Admin must provide tenantId)."
                    },
                    "response": []
                },
                {
                    "name": "Create Coupon (Manager)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 201) {",
                                    "    var jsonData = pm.response.json();",
                                    "    pm.environment.set('coupon_id', jsonData.coupon._id);",
                                    "    pm.environment.set('coupon_code', jsonData.coupon.code);",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"title\": \"Summer Sale 20% Off\",\n    \"code\": \"SUMMER_20\",\n    \"discount\": 20,\n    \"validUpto\": \"2026-08-31\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/coupons",
                            "host": ["{{base_url}}"],
                            "path": ["coupons"]
                        },
                        "description": "Create a new coupon (Manager - tenantId from JWT)."
                    },
                    "response": []
                },
                {
                    "name": "Update Coupon",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"title\": \"Updated Title - Mega Sale\",\n    \"discount\": 25\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/coupons/{{coupon_id}}",
                            "host": ["{{base_url}}"],
                            "path": ["coupons", "{{coupon_id}}"]
                        },
                        "description": "Update coupon information."
                    },
                    "response": []
                },
                {
                    "name": "Delete Coupon",
                    "request": {
                        "method": "DELETE",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/coupons/{{coupon_id}}",
                            "host": ["{{base_url}}"],
                            "path": ["coupons", "{{coupon_id}}"]
                        },
                        "description": "Delete a coupon."
                    },
                    "response": []
                },
                {
                    "name": "Verify Coupon",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"code\": \"{{coupon_code}}\",\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/coupons/verify",
                            "host": ["{{base_url}}"],
                            "path": ["coupons", "verify"]
                        },
                        "description": "Verify if a coupon code is valid for a tenant."
                    },
                    "response": []
                },
                {
                    "name": "[Edge] Verify Expired Coupon",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"code\": \"EXPIRED_CODE\",\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/coupons/verify",
                            "host": ["{{base_url}}"],
                            "path": ["coupons", "verify"]
                        },
                        "description": "Test: Verify an expired coupon. Expected: 400 error."
                    },
                    "response": []
                },
                {
                    "name": "[Edge] Verify Invalid Coupon",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"code\": \"INVALID_CODE_123\",\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/coupons/verify",
                            "host": ["{{base_url}}"],
                            "path": ["coupons", "verify"]
                        },
                        "description": "Test: Verify non-existent coupon. Expected: 404 error."
                    },
                    "response": []
                }
            ],
            "description": "Coupon management endpoints with case-insensitive codes."
        },
        {
            "name": "Order Management",
            "item": [
                {
                    "name": "Create Order (Basic)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 201) {",
                                    "    var jsonData = pm.response.json();",
                                    "    pm.environment.set('order_id', jsonData.order._id);",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"address\": \"123 Main Street, City, Country\",\n    \"items\": [\n        {\n            \"_id\": \"{{product_id}}\",\n            \"name\": \"Margherita Pizza\",\n            \"image\": \"https://example.com/pizza.jpg\",\n            \"qty\": 2,\n            \"priceConfiguration\": {\n                \"Size\": \"Medium\",\n                \"Crust\": \"Thin\"\n            },\n            \"toppings\": [],\n            \"totalPrice\": 500\n        }\n    ],\n    \"total\": 550,\n    \"paymentMode\": \"card\",\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/orders",
                            "host": ["{{base_url}}"],
                            "path": ["orders"]
                        },
                        "description": "Create a new order.\n\n**Required Fields:**\n- address: Delivery address\n- items: Array of order items\n- total: Order total\n- paymentMode: card, cash, upi, netbanking, wallet\n- tenantId: Required for Admin and Customer\n\n**Price Validation:**\n- Server validates all prices against database\n- Products and toppings are validated\n- Tax and delivery charges are calculated server-side"
                    },
                    "response": []
                },
                {
                    "name": "Create Order (With Coupon)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 201) {",
                                    "    var jsonData = pm.response.json();",
                                    "    pm.environment.set('order_id', jsonData.order._id);",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"address\": \"123 Main Street, City, Country\",\n    \"items\": [\n        {\n            \"_id\": \"{{product_id}}\",\n            \"name\": \"Margherita Pizza\",\n            \"image\": \"https://example.com/pizza.jpg\",\n            \"qty\": 2,\n            \"priceConfiguration\": {\n                \"Size\": \"Medium\",\n                \"Crust\": \"Thin\"\n            },\n            \"toppings\": [],\n            \"totalPrice\": 500\n        }\n    ],\n    \"couponCode\": \"{{coupon_code}}\",\n    \"discount\": 50,\n    \"taxTotal\": 81,\n    \"deliveryCharge\": 30,\n    \"total\": 561,\n    \"paymentMode\": \"upi\",\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/orders",
                            "host": ["{{base_url}}"],
                            "path": ["orders"]
                        },
                        "description": "Create order with coupon code applied.\n\n**Optional Fields:**\n- couponCode: Valid coupon code\n- discount: Discount amount (validated against coupon)\n- taxTotal: Tax amount (validated against tax config)\n- deliveryCharge: Delivery charge (validated against delivery config)"
                    },
                    "response": []
                },
                {
                    "name": "Create Order (With Toppings)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 201) {",
                                    "    var jsonData = pm.response.json();",
                                    "    pm.environment.set('order_id', jsonData.order._id);",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"address\": \"456 Oak Avenue, City, Country\",\n    \"items\": [\n        {\n            \"_id\": \"{{product_id}}\",\n            \"name\": \"Pepperoni Pizza\",\n            \"image\": \"https://example.com/pepperoni.jpg\",\n            \"qty\": 1,\n            \"priceConfiguration\": {\n                \"Size\": \"Large\",\n                \"Crust\": \"Thick\"\n            },\n            \"toppings\": [\n                {\n                    \"_id\": \"{{topping_id}}\",\n                    \"name\": \"Extra Cheese\",\n                    \"image\": \"https://example.com/cheese.jpg\",\n                    \"price\": 50\n                },\n                {\n                    \"_id\": \"{{topping_id_2}}\",\n                    \"name\": \"Jalapenos\",\n                    \"image\": \"https://example.com/jalapeno.jpg\",\n                    \"price\": 30\n                }\n            ],\n            \"totalPrice\": 430\n        }\n    ],\n    \"total\": 480,\n    \"paymentMode\": \"cash\",\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/orders",
                            "host": ["{{base_url}}"],
                            "path": ["orders"]
                        },
                        "description": "Create order with toppings. Topping prices are validated against database."
                    },
                    "response": []
                },
                {
                    "name": "Create Order (Multiple Items)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 201) {",
                                    "    var jsonData = pm.response.json();",
                                    "    pm.environment.set('order_id', jsonData.order._id);",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"address\": \"789 Pine Road, City, Country\",\n    \"items\": [\n        {\n            \"_id\": \"{{product_id}}\",\n            \"name\": \"Margherita Pizza\",\n            \"image\": \"https://example.com/margherita.jpg\",\n            \"qty\": 2,\n            \"priceConfiguration\": {\n                \"Size\": \"Medium\",\n                \"Crust\": \"Thin\"\n            },\n            \"toppings\": [],\n            \"totalPrice\": 400\n        },\n        {\n            \"_id\": \"{{product_id_2}}\",\n            \"name\": \"Garlic Bread\",\n            \"image\": \"https://example.com/garlic.jpg\",\n            \"qty\": 1,\n            \"priceConfiguration\": {\n                \"Size\": \"Regular\"\n            },\n            \"toppings\": [],\n            \"totalPrice\": 120\n        },\n        {\n            \"_id\": \"{{product_id_3}}\",\n            \"name\": \"Coca Cola\",\n            \"image\": \"https://example.com/coke.jpg\",\n            \"qty\": 3,\n            \"priceConfiguration\": {\n                \"Size\": \"500ml\"\n            },\n            \"toppings\": [],\n            \"totalPrice\": 150\n        }\n    ],\n    \"total\": 750,\n    \"paymentMode\": \"wallet\",\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/orders",
                            "host": ["{{base_url}}"],
                            "path": ["orders"]
                        },
                        "description": "Create order with multiple different items."
                    },
                    "response": []
                },
                {
                    "name": "Get All Orders",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/orders?page={{page}}&limit={{limit}}",
                            "host": ["{{base_url}}"],
                            "path": ["orders"],
                            "query": [
                                {
                                    "key": "page",
                                    "value": "{{page}}"
                                },
                                {
                                    "key": "limit",
                                    "value": "{{limit}}"
                                },
                                {
                                    "key": "tenantId",
                                    "value": "{{tenant_id}}",
                                    "disabled": true
                                },
                                {
                                    "key": "status",
                                    "value": "pending",
                                    "disabled": true
                                },
                                {
                                    "key": "customerId",
                                    "value": "",
                                    "disabled": true
                                },
                                {
                                    "key": "q",
                                    "value": "",
                                    "disabled": true
                                }
                            ]
                        },
                        "description": "Get all orders with filters.\n\n**Role-based filtering:**\n- Admin: All orders, can filter by tenantId\n- Manager: Only their tenant's orders\n- Customer: Only their own orders\n\n**Query Parameters:**\n- page, limit: Pagination\n- tenantId: Filter by tenant (Admin only)\n- status: Filter by status\n- customerId: Filter by customer\n- q: Search query"
                    },
                    "response": []
                },
                {
                    "name": "Get All Orders (Filter by Status)",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/orders?status=pending",
                            "host": ["{{base_url}}"],
                            "path": ["orders"],
                            "query": [
                                {
                                    "key": "status",
                                    "value": "pending"
                                }
                            ]
                        },
                        "description": "Get orders filtered by status.\n\n**Valid statuses:**\n- pending\n- confirmed\n- preparing\n- out_for_delivery\n- delivered\n- cancelled"
                    },
                    "response": []
                },
                {
                    "name": "Get All Orders (Filter by Tenant)",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/orders?tenantId={{tenant_id}}",
                            "host": ["{{base_url}}"],
                            "path": ["orders"],
                            "query": [
                                {
                                    "key": "tenantId",
                                    "value": "{{tenant_id}}"
                                }
                            ]
                        },
                        "description": "Get orders filtered by tenant (Admin only)."
                    },
                    "response": []
                },
                {
                    "name": "Get My Orders (Customer)",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/orders/my-orders",
                            "host": ["{{base_url}}"],
                            "path": ["orders", "my-orders"]
                        },
                        "description": "Get all orders for the current customer (Customer role only)."
                    },
                    "response": []
                },
                {
                    "name": "Get Order by ID",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/orders/{{order_id}}",
                            "host": ["{{base_url}}"],
                            "path": ["orders", "{{order_id}}"]
                        },
                        "description": "Get a specific order by ID.\n\n**Authorization:**\n- Admin: Can view any order\n- Manager: Can only view orders from their tenant\n- Customer: Can only view their own orders"
                    },
                    "response": []
                },
                {
                    "name": "Update Order Status (Confirm)",
                    "request": {
                        "method": "PATCH",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"status\": \"confirmed\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/orders/{{order_id}}/status",
                            "host": ["{{base_url}}"],
                            "path": ["orders", "{{order_id}}", "status"]
                        },
                        "description": "Update order status to confirmed."
                    },
                    "response": []
                },
                {
                    "name": "Update Order Status (Preparing)",
                    "request": {
                        "method": "PATCH",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"status\": \"preparing\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/orders/{{order_id}}/status",
                            "host": ["{{base_url}}"],
                            "path": ["orders", "{{order_id}}", "status"]
                        },
                        "description": "Update order status to preparing."
                    },
                    "response": []
                },
                {
                    "name": "Update Order Status (Out for Delivery)",
                    "request": {
                        "method": "PATCH",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"status\": \"out_for_delivery\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/orders/{{order_id}}/status",
                            "host": ["{{base_url}}"],
                            "path": ["orders", "{{order_id}}", "status"]
                        },
                        "description": "Update order status to out_for_delivery."
                    },
                    "response": []
                },
                {
                    "name": "Update Order Status (Delivered)",
                    "request": {
                        "method": "PATCH",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"status\": \"delivered\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/orders/{{order_id}}/status",
                            "host": ["{{base_url}}"],
                            "path": ["orders", "{{order_id}}", "status"]
                        },
                        "description": "Update order status to delivered."
                    },
                    "response": []
                },
                {
                    "name": "Update Order Status (Cancel - Customer)",
                    "request": {
                        "method": "PATCH",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"status\": \"cancelled\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/orders/{{order_id}}/status",
                            "host": ["{{base_url}}"],
                            "path": ["orders", "{{order_id}}", "status"]
                        },
                        "description": "Cancel an order.\n\n**Customer restrictions:**\n- Customers can ONLY cancel orders (not other status updates)\n- Customers can only cancel their OWN orders"
                    },
                    "response": []
                },
                {
                    "name": "Delete Order",
                    "request": {
                        "method": "DELETE",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/orders/{{order_id}}",
                            "host": ["{{base_url}}"],
                            "path": ["orders", "{{order_id}}"]
                        },
                        "description": "Delete an order.\n\n**Requires:** Admin or Manager role\n\n**Manager restriction:** Can only delete orders from their tenant"
                    },
                    "response": []
                },
                {
                    "name": "[Edge] Create Order - Missing Address",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"items\": [\n        {\n            \"_id\": \"{{product_id}}\",\n            \"name\": \"Pizza\",\n            \"image\": \"https://example.com/pizza.jpg\",\n            \"qty\": 1,\n            \"priceConfiguration\": {\"Size\": \"Medium\"},\n            \"toppings\": [],\n            \"totalPrice\": 250\n        }\n    ],\n    \"total\": 250,\n    \"paymentMode\": \"cash\",\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/orders",
                            "host": ["{{base_url}}"],
                            "path": ["orders"]
                        },
                        "description": "Test: Create order without address. Expected: 400 validation error."
                    },
                    "response": []
                },
                {
                    "name": "[Edge] Create Order - Empty Items",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"address\": \"123 Main Street\",\n    \"items\": [],\n    \"total\": 0,\n    \"paymentMode\": \"cash\",\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/orders",
                            "host": ["{{base_url}}"],
                            "path": ["orders"]
                        },
                        "description": "Test: Create order with empty items array. Expected: 400 validation error."
                    },
                    "response": []
                },
                {
                    "name": "[Edge] Create Order - Invalid Payment Mode",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"address\": \"123 Main Street\",\n    \"items\": [\n        {\n            \"_id\": \"{{product_id}}\",\n            \"name\": \"Pizza\",\n            \"image\": \"https://example.com/pizza.jpg\",\n            \"qty\": 1,\n            \"priceConfiguration\": {\"Size\": \"Medium\"},\n            \"toppings\": [],\n            \"totalPrice\": 250\n        }\n    ],\n    \"total\": 250,\n    \"paymentMode\": \"bitcoin\",\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/orders",
                            "host": ["{{base_url}}"],
                            "path": ["orders"]
                        },
                        "description": "Test: Create order with invalid payment mode. Expected: 400 validation error.\n\nValid modes: card, cash, upi, netbanking, wallet"
                    },
                    "response": []
                },
                {
                    "name": "[Edge] Create Order - Invalid Coupon",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"address\": \"123 Main Street\",\n    \"items\": [\n        {\n            \"_id\": \"{{product_id}}\",\n            \"name\": \"Pizza\",\n            \"image\": \"https://example.com/pizza.jpg\",\n            \"qty\": 1,\n            \"priceConfiguration\": {\"Size\": \"Medium\"},\n            \"toppings\": [],\n            \"totalPrice\": 250\n        }\n    ],\n    \"couponCode\": \"INVALID_COUPON_XYZ\",\n    \"total\": 250,\n    \"paymentMode\": \"cash\",\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/orders",
                            "host": ["{{base_url}}"],
                            "path": ["orders"]
                        },
                        "description": "Test: Create order with invalid coupon code. Expected: 400 error."
                    },
                    "response": []
                },
                {
                    "name": "[Edge] Create Order - Price Mismatch",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"address\": \"123 Main Street\",\n    \"items\": [\n        {\n            \"_id\": \"{{product_id}}\",\n            \"name\": \"Pizza\",\n            \"image\": \"https://example.com/pizza.jpg\",\n            \"qty\": 1,\n            \"priceConfiguration\": {\"Size\": \"Medium\"},\n            \"toppings\": [],\n            \"totalPrice\": 1\n        }\n    ],\n    \"total\": 1,\n    \"paymentMode\": \"cash\",\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/orders",
                            "host": ["{{base_url}}"],
                            "path": ["orders"]
                        },
                        "description": "Test: Create order with wrong price. Expected: 400 price validation error.\n\nServer validates all prices against database."
                    },
                    "response": []
                },
                {
                    "name": "[Edge] Create Order - Invalid Product ID",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"address\": \"123 Main Street\",\n    \"items\": [\n        {\n            \"_id\": \"invalid_product_id_123\",\n            \"name\": \"Non-existent Product\",\n            \"image\": \"https://example.com/fake.jpg\",\n            \"qty\": 1,\n            \"priceConfiguration\": {\"Size\": \"Medium\"},\n            \"toppings\": [],\n            \"totalPrice\": 250\n        }\n    ],\n    \"total\": 250,\n    \"paymentMode\": \"cash\",\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/orders",
                            "host": ["{{base_url}}"],
                            "path": ["orders"]
                        },
                        "description": "Test: Create order with non-existent product. Expected: 400 error."
                    },
                    "response": []
                },
                {
                    "name": "[Edge] Create Order - Zero Quantity",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"address\": \"123 Main Street\",\n    \"items\": [\n        {\n            \"_id\": \"{{product_id}}\",\n            \"name\": \"Pizza\",\n            \"image\": \"https://example.com/pizza.jpg\",\n            \"qty\": 0,\n            \"priceConfiguration\": {\"Size\": \"Medium\"},\n            \"toppings\": [],\n            \"totalPrice\": 250\n        }\n    ],\n    \"total\": 250,\n    \"paymentMode\": \"cash\",\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/orders",
                            "host": ["{{base_url}}"],
                            "path": ["orders"]
                        },
                        "description": "Test: Create order with zero quantity. Expected: 400 validation error."
                    },
                    "response": []
                },
                {
                    "name": "[Edge] Get Order - Not Found",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/orders/507f1f77bcf86cd799439011",
                            "host": ["{{base_url}}"],
                            "path": ["orders", "507f1f77bcf86cd799439011"]
                        },
                        "description": "Test: Get non-existent order. Expected: 404 error."
                    },
                    "response": []
                },
                {
                    "name": "[Edge] Get Order - Invalid ID Format",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/orders/invalid-id",
                            "host": ["{{base_url}}"],
                            "path": ["orders", "invalid-id"]
                        },
                        "description": "Test: Get order with invalid MongoDB ID format. Expected: 400 validation error."
                    },
                    "response": []
                },
                {
                    "name": "[Edge] Update Status - Invalid Status",
                    "request": {
                        "method": "PATCH",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"status\": \"invalid_status\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/orders/{{order_id}}/status",
                            "host": ["{{base_url}}"],
                            "path": ["orders", "{{order_id}}", "status"]
                        },
                        "description": "Test: Update with invalid status. Expected: 400 validation error.\n\nValid statuses: pending, confirmed, preparing, out_for_delivery, delivered, cancelled"
                    },
                    "response": []
                },
                {
                    "name": "[Edge] Customer Update Status - Not Cancel",
                    "request": {
                        "method": "PATCH",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"status\": \"delivered\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/orders/{{order_id}}/status",
                            "host": ["{{base_url}}"],
                            "path": ["orders", "{{order_id}}", "status"]
                        },
                        "description": "Test: Customer trying to set status other than cancelled. Expected: 403 error.\n\nCustomers can ONLY cancel orders."
                    },
                    "response": []
                },
                {
                    "name": "[Edge] Admin - Missing TenantId",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"address\": \"123 Main Street\",\n    \"items\": [\n        {\n            \"_id\": \"{{product_id}}\",\n            \"name\": \"Pizza\",\n            \"image\": \"https://example.com/pizza.jpg\",\n            \"qty\": 1,\n            \"priceConfiguration\": {\"Size\": \"Medium\"},\n            \"toppings\": [],\n            \"totalPrice\": 250\n        }\n    ],\n    \"total\": 250,\n    \"paymentMode\": \"cash\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/orders",
                            "host": ["{{base_url}}"],
                            "path": ["orders"]
                        },
                        "description": "Test: Admin creating order without tenantId. Expected: 400 error.\n\nAdmin must provide tenantId in request body."
                    },
                    "response": []
                }
            ],
            "description": "Order management endpoints with full price validation.\n\n**Payment Modes:** card, cash, upi, netbanking, wallet\n\n**Order Statuses:** pending, confirmed, preparing, out_for_delivery, delivered, cancelled\n\n**Server-side Validation:**\n- Product prices\n- Topping prices\n- Coupon validity\n- Tax calculation\n- Delivery charges"
        },
        {
            "name": "Tax Configuration",
            "item": [
                {
                    "name": "Create Tax Config (Admin)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 201) {",
                                    "    var jsonData = pm.response.json();",
                                    "    pm.environment.set('tax_config_id', jsonData.config._id);",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"taxes\": [\n        {\n            \"name\": \"CGST\",\n            \"rate\": 9,\n            \"isActive\": true\n        },\n        {\n            \"name\": \"SGST\",\n            \"rate\": 9,\n            \"isActive\": true\n        }\n    ],\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/taxes",
                            "host": ["{{base_url}}"],
                            "path": ["taxes"]
                        },
                        "description": "Create tax configuration for a tenant.\n\n**Admin:** Must provide tenantId\n**Manager:** Uses tenant from JWT\n\n**Tax Fields:**\n- name: Tax name (e.g., CGST, SGST, VAT)\n- rate: Tax percentage (0-100)\n- isActive: Enable/disable individual tax"
                    },
                    "response": []
                },
                {
                    "name": "Create Tax Config (Manager)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 201) {",
                                    "    var jsonData = pm.response.json();",
                                    "    pm.environment.set('tax_config_id', jsonData.config._id);",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"taxes\": [\n        {\n            \"name\": \"CGST\",\n            \"rate\": 9,\n            \"isActive\": true\n        },\n        {\n            \"name\": \"SGST\",\n            \"rate\": 9,\n            \"isActive\": true\n        }\n    ]\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/taxes",
                            "host": ["{{base_url}}"],
                            "path": ["taxes"]
                        },
                        "description": "Create tax configuration (Manager version - no tenantId needed)."
                    },
                    "response": []
                },
                {
                    "name": "Create Tax Config (GST + Service Tax)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"taxes\": [\n        {\n            \"name\": \"CGST\",\n            \"rate\": 2.5,\n            \"isActive\": true\n        },\n        {\n            \"name\": \"SGST\",\n            \"rate\": 2.5,\n            \"isActive\": true\n        },\n        {\n            \"name\": \"Service Tax\",\n            \"rate\": 5,\n            \"isActive\": false\n        }\n    ],\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/taxes",
                            "host": ["{{base_url}}"],
                            "path": ["taxes"]
                        },
                        "description": "Example: Multiple tax components with different active states."
                    },
                    "response": []
                },
                {
                    "name": "Get Tax Config",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/taxes?tenantId={{tenant_id}}",
                            "host": ["{{base_url}}"],
                            "path": ["taxes"],
                            "query": [
                                {
                                    "key": "tenantId",
                                    "value": "{{tenant_id}}"
                                }
                            ]
                        },
                        "description": "Get tax configuration for a tenant.\n\n**Admin:** Must provide tenantId query param\n**Manager:** Uses tenant from JWT\n**Customer:** Must provide tenantId"
                    },
                    "response": []
                },
                {
                    "name": "Update Tax Config",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"taxes\": [\n        {\n            \"name\": \"CGST\",\n            \"rate\": 6,\n            \"isActive\": true\n        },\n        {\n            \"name\": \"SGST\",\n            \"rate\": 6,\n            \"isActive\": true\n        },\n        {\n            \"name\": \"Cess\",\n            \"rate\": 1,\n            \"isActive\": true\n        }\n    ],\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/taxes",
                            "host": ["{{base_url}}"],
                            "path": ["taxes"]
                        },
                        "description": "Update tax configuration (upsert - creates if not exists)."
                    },
                    "response": []
                },
                {
                    "name": "Toggle Tax (Enable)",
                    "request": {
                        "method": "PATCH",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"taxName\": \"CGST\",\n    \"isActive\": true,\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/taxes/toggle",
                            "host": ["{{base_url}}"],
                            "path": ["taxes", "toggle"]
                        },
                        "description": "Enable a specific tax component."
                    },
                    "response": []
                },
                {
                    "name": "Toggle Tax (Disable)",
                    "request": {
                        "method": "PATCH",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"taxName\": \"SGST\",\n    \"isActive\": false,\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/taxes/toggle",
                            "host": ["{{base_url}}"],
                            "path": ["taxes", "toggle"]
                        },
                        "description": "Disable a specific tax component. Disabled taxes are not applied to orders."
                    },
                    "response": []
                },
                {
                    "name": "Delete Tax Config",
                    "request": {
                        "method": "DELETE",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/taxes",
                            "host": ["{{base_url}}"],
                            "path": ["taxes"]
                        },
                        "description": "Delete tax configuration for a tenant."
                    },
                    "response": []
                },
                {
                    "name": "[Edge] Create Tax - Already Exists",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"taxes\": [\n        {\n            \"name\": \"VAT\",\n            \"rate\": 10,\n            \"isActive\": true\n        }\n    ],\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/taxes",
                            "host": ["{{base_url}}"],
                            "path": ["taxes"]
                        },
                        "description": "Test: Create tax config when one already exists. Expected: 409 Conflict.\n\nUse PUT to update existing config."
                    },
                    "response": []
                },
                {
                    "name": "[Edge] Create Tax - Empty Array",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"taxes\": [],\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/taxes",
                            "host": ["{{base_url}}"],
                            "path": ["taxes"]
                        },
                        "description": "Test: Create tax config with empty taxes array. Expected: 400 validation error."
                    },
                    "response": []
                },
                {
                    "name": "[Edge] Create Tax - Invalid Rate",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"taxes\": [\n        {\n            \"name\": \"Invalid Tax\",\n            \"rate\": 150,\n            \"isActive\": true\n        }\n    ],\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/taxes",
                            "host": ["{{base_url}}"],
                            "path": ["taxes"]
                        },
                        "description": "Test: Create tax with rate > 100. Expected: 400 validation error."
                    },
                    "response": []
                },
                {
                    "name": "[Edge] Toggle Tax - Not Found",
                    "request": {
                        "method": "PATCH",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"taxName\": \"NON_EXISTENT_TAX\",\n    \"isActive\": true,\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/taxes/toggle",
                            "host": ["{{base_url}}"],
                            "path": ["taxes", "toggle"]
                        },
                        "description": "Test: Toggle non-existent tax. Expected: 404 error."
                    },
                    "response": []
                },
                {
                    "name": "[Edge] Get Tax - No Config",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/taxes?tenantId=non_existent_tenant",
                            "host": ["{{base_url}}"],
                            "path": ["taxes"],
                            "query": [
                                {
                                    "key": "tenantId",
                                    "value": "non_existent_tenant"
                                }
                            ]
                        },
                        "description": "Test: Get tax config for tenant without config. Expected: 404 error."
                    },
                    "response": []
                }
            ],
            "description": "Tax configuration endpoints.\n\n**Features:**\n- Multiple tax components per tenant\n- Individual tax toggle (enable/disable)\n- Tax applied to taxable amount (after discount)\n- Only active taxes are calculated"
        },
        {
            "name": "Delivery Configuration",
            "item": [
                {
                    "name": "Create Delivery Config (Admin)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 201) {",
                                    "    var jsonData = pm.response.json();",
                                    "    pm.environment.set('delivery_config_id', jsonData.config._id);",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"isActive\": true,\n    \"orderValueTiers\": [\n        {\n            \"minOrderValue\": 0,\n            \"deliveryCharge\": 50\n        },\n        {\n            \"minOrderValue\": 200,\n            \"deliveryCharge\": 30\n        },\n        {\n            \"minOrderValue\": 500,\n            \"deliveryCharge\": 0\n        }\n    ],\n    \"freeDeliveryThreshold\": 1000,\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/delivery",
                            "host": ["{{base_url}}"],
                            "path": ["delivery"]
                        },
                        "description": "Create delivery configuration for a tenant.\n\n**Fields:**\n- isActive: Enable/disable delivery charges\n- orderValueTiers: Array of tiers based on order value\n- freeDeliveryThreshold: Optional threshold for free delivery\n\n**Tier Logic:**\n- Orders < 200: Rs 50 delivery\n- Orders 200-500: Rs 30 delivery\n- Orders >= 500: Free delivery\n- Orders >= 1000: Always free (threshold)"
                    },
                    "response": []
                },
                {
                    "name": "Create Delivery Config (Manager)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "if (pm.response.code === 201) {",
                                    "    var jsonData = pm.response.json();",
                                    "    pm.environment.set('delivery_config_id', jsonData.config._id);",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"isActive\": true,\n    \"orderValueTiers\": [\n        {\n            \"minOrderValue\": 0,\n            \"deliveryCharge\": 40\n        },\n        {\n            \"minOrderValue\": 300,\n            \"deliveryCharge\": 20\n        },\n        {\n            \"minOrderValue\": 600,\n            \"deliveryCharge\": 0\n        }\n    ],\n    \"freeDeliveryThreshold\": 800\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/delivery",
                            "host": ["{{base_url}}"],
                            "path": ["delivery"]
                        },
                        "description": "Create delivery configuration (Manager version - tenantId from JWT)."
                    },
                    "response": []
                },
                {
                    "name": "Create Delivery Config (Future Distance-based)",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"isActive\": true,\n    \"orderValueTiers\": [\n        {\n            \"minOrderValue\": 0,\n            \"deliveryCharge\": 50,\n            \"perKmCharge\": 10\n        },\n        {\n            \"minOrderValue\": 300,\n            \"deliveryCharge\": 30,\n            \"perKmCharge\": 5\n        },\n        {\n            \"minOrderValue\": 700,\n            \"deliveryCharge\": 0,\n            \"perKmCharge\": 0\n        }\n    ],\n    \"freeDeliveryThreshold\": 1500,\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/delivery",
                            "host": ["{{base_url}}"],
                            "path": ["delivery"]
                        },
                        "description": "Example: Config with perKmCharge for future distance-based pricing.\n\n**Note:** perKmCharge is stored but not used until OSRM is integrated."
                    },
                    "response": []
                },
                {
                    "name": "Get Delivery Config",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/delivery?tenantId={{tenant_id}}",
                            "host": ["{{base_url}}"],
                            "path": ["delivery"],
                            "query": [
                                {
                                    "key": "tenantId",
                                    "value": "{{tenant_id}}"
                                }
                            ]
                        },
                        "description": "Get delivery configuration for a tenant."
                    },
                    "response": []
                },
                {
                    "name": "Calculate Delivery Charge",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/delivery/calculate?tenantId={{tenant_id}}&orderSubTotal=250",
                            "host": ["{{base_url}}"],
                            "path": ["delivery", "calculate"],
                            "query": [
                                {
                                    "key": "tenantId",
                                    "value": "{{tenant_id}}"
                                },
                                {
                                    "key": "orderSubTotal",
                                    "value": "250"
                                }
                            ]
                        },
                        "description": "Calculate delivery charge for a given order subtotal.\n\n**Use Case:** Checkout preview before placing order.\n\n**Response includes:**\n- deliveryCharge: Amount to charge\n- isFreeDelivery: Boolean\n- freeDeliveryReason: disabled, threshold, or tier\n- appliedTier: Which tier was applied"
                    },
                    "response": []
                },
                {
                    "name": "Calculate Delivery (Low Order)",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/delivery/calculate?tenantId={{tenant_id}}&orderSubTotal=100",
                            "host": ["{{base_url}}"],
                            "path": ["delivery", "calculate"],
                            "query": [
                                {
                                    "key": "tenantId",
                                    "value": "{{tenant_id}}"
                                },
                                {
                                    "key": "orderSubTotal",
                                    "value": "100"
                                }
                            ]
                        },
                        "description": "Calculate for low order value. Expected: Highest delivery charge tier."
                    },
                    "response": []
                },
                {
                    "name": "Calculate Delivery (Medium Order)",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/delivery/calculate?tenantId={{tenant_id}}&orderSubTotal=350",
                            "host": ["{{base_url}}"],
                            "path": ["delivery", "calculate"],
                            "query": [
                                {
                                    "key": "tenantId",
                                    "value": "{{tenant_id}}"
                                },
                                {
                                    "key": "orderSubTotal",
                                    "value": "350"
                                }
                            ]
                        },
                        "description": "Calculate for medium order value. Expected: Middle tier charge."
                    },
                    "response": []
                },
                {
                    "name": "Calculate Delivery (High Order)",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/delivery/calculate?tenantId={{tenant_id}}&orderSubTotal=600",
                            "host": ["{{base_url}}"],
                            "path": ["delivery", "calculate"],
                            "query": [
                                {
                                    "key": "tenantId",
                                    "value": "{{tenant_id}}"
                                },
                                {
                                    "key": "orderSubTotal",
                                    "value": "600"
                                }
                            ]
                        },
                        "description": "Calculate for high order value. Expected: Free delivery (tier)."
                    },
                    "response": []
                },
                {
                    "name": "Calculate Delivery (Above Threshold)",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/delivery/calculate?tenantId={{tenant_id}}&orderSubTotal=1200",
                            "host": ["{{base_url}}"],
                            "path": ["delivery", "calculate"],
                            "query": [
                                {
                                    "key": "tenantId",
                                    "value": "{{tenant_id}}"
                                },
                                {
                                    "key": "orderSubTotal",
                                    "value": "1200"
                                }
                            ]
                        },
                        "description": "Calculate for order above threshold. Expected: Free delivery (threshold reason)."
                    },
                    "response": []
                },
                {
                    "name": "Update Delivery Config",
                    "request": {
                        "method": "PUT",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"isActive\": true,\n    \"orderValueTiers\": [\n        {\n            \"minOrderValue\": 0,\n            \"deliveryCharge\": 60\n        },\n        {\n            \"minOrderValue\": 250,\n            \"deliveryCharge\": 40\n        },\n        {\n            \"minOrderValue\": 400,\n            \"deliveryCharge\": 20\n        },\n        {\n            \"minOrderValue\": 600,\n            \"deliveryCharge\": 0\n        }\n    ],\n    \"freeDeliveryThreshold\": 1200,\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/delivery",
                            "host": ["{{base_url}}"],
                            "path": ["delivery"]
                        },
                        "description": "Update delivery configuration (upsert - creates if not exists)."
                    },
                    "response": []
                },
                {
                    "name": "Toggle Delivery (Disable)",
                    "request": {
                        "method": "PATCH",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"isActive\": false,\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/delivery/toggle",
                            "host": ["{{base_url}}"],
                            "path": ["delivery", "toggle"]
                        },
                        "description": "Disable delivery charges. When disabled, delivery is free."
                    },
                    "response": []
                },
                {
                    "name": "Toggle Delivery (Enable)",
                    "request": {
                        "method": "PATCH",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"isActive\": true,\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/delivery/toggle",
                            "host": ["{{base_url}}"],
                            "path": ["delivery", "toggle"]
                        },
                        "description": "Enable delivery charges."
                    },
                    "response": []
                },
                {
                    "name": "Delete Delivery Config",
                    "request": {
                        "method": "DELETE",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/delivery",
                            "host": ["{{base_url}}"],
                            "path": ["delivery"]
                        },
                        "description": "Delete delivery configuration for a tenant."
                    },
                    "response": []
                },
                {
                    "name": "[Edge] Create Delivery - Already Exists",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"isActive\": true,\n    \"orderValueTiers\": [\n        {\n            \"minOrderValue\": 0,\n            \"deliveryCharge\": 25\n        }\n    ],\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/delivery",
                            "host": ["{{base_url}}"],
                            "path": ["delivery"]
                        },
                        "description": "Test: Create config when one exists. Expected: 409 Conflict.\n\nUse PUT to update."
                    },
                    "response": []
                },
                {
                    "name": "[Edge] Create Delivery - Empty Tiers",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"isActive\": true,\n    \"orderValueTiers\": [],\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/delivery",
                            "host": ["{{base_url}}"],
                            "path": ["delivery"]
                        },
                        "description": "Test: Create with empty tiers array. Expected: 400 validation error."
                    },
                    "response": []
                },
                {
                    "name": "[Edge] Create Delivery - Negative Charge",
                    "request": {
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n    \"isActive\": true,\n    \"orderValueTiers\": [\n        {\n            \"minOrderValue\": 0,\n            \"deliveryCharge\": -10\n        }\n    ],\n    \"tenantId\": \"{{tenant_id}}\"\n}"
                        },
                        "url": {
                            "raw": "{{base_url}}/delivery",
                            "host": ["{{base_url}}"],
                            "path": ["delivery"]
                        },
                        "description": "Test: Create with negative delivery charge. Expected: 400 validation error."
                    },
                    "response": []
                },
                {
                    "name": "[Edge] Calculate - Missing Params",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/delivery/calculate?tenantId={{tenant_id}}",
                            "host": ["{{base_url}}"],
                            "path": ["delivery", "calculate"],
                            "query": [
                                {
                                    "key": "tenantId",
                                    "value": "{{tenant_id}}"
                                }
                            ]
                        },
                        "description": "Test: Calculate without orderSubTotal. Expected: 400 error."
                    },
                    "response": []
                },
                {
                    "name": "[Edge] Get Delivery - No Config",
                    "request": {
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{base_url}}/delivery?tenantId=non_existent_tenant",
                            "host": ["{{base_url}}"],
                            "path": ["delivery"],
                            "query": [
                                {
                                    "key": "tenantId",
                                    "value": "non_existent_tenant"
                                }
                            ]
                        },
                        "description": "Test: Get config for tenant without delivery config. Expected: 404 error."
                    },
                    "response": []
                }
            ],
            "description": "Delivery configuration endpoints.\n\n**Features:**\n- Order value-based tiers\n- Free delivery threshold\n- Enable/disable toggle\n- Future-ready for distance-based pricing (OSRM)\n\n**Tier Logic:**\nApplies the highest minOrderValue tier where order >= minOrderValue"
        }
    ],
    "variable": [
        {
            "key": "base_url",
            "value": "http://localhost:5503",
            "type": "string"
        }
    ]
}
